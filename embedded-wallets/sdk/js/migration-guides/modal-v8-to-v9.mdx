---
title: PnP Modal SDK - v8 to v9
description: 'PnP Modal SDK - v8 to v9 | Embedded Wallets'
sidebar_label: v8 to v9
---

import Dashboard from '@site/static/img/w3a-dashboard/dashboard-private-key-export.png'

This migration guide provides steps for upgrading from version v8 to v9 of the Web3Auth PnP Modal SDK. The guide outlines significant changes and enhancements, including the support of additonal parameters in Wallet Services function, and build size reduction by 25%.

## Breaking Changes

### OpenloginAdapter is now AuthAdapter

In v9, we are deprecating the `OpenloginAdapter` and introducing the `AuthAdapter`. Additionally, `OpenloginAdapterOptions` has been renamed to `AuthAdapterOptions`. These changes have been made to enhance naming consistency. It's important to note that while the names have changed, the parameters used in the adapter settings remain the same.

```tsx
// remove-next-line
import { OpenloginAdapter } from '@web3auth/openlogin-adapter'
// add-next-line
import { AuthAdapter } from '@web3auth/auth-adapter'

// remove-next-line
const loginAdapter = new OpenloginAdapter(OpenloginAdapterOptions)
// add-next-line
const loginAdapter = new AuthAdapter(AuthAdapterOptions)
```

### Private Key Provider in now needed in the Web3Auth Constructor

Although not marked as a mandatory param in the SDK, you need to pass the privateKeyProvider in the Web3Auth Constructor to avoid unexpected issues.

```tsx
// add-start
const privateKeyProvider = new EthereumPrivateKeyProvider({
  config: {
    chainConfig,
  },
})
// add-end

const web3AuthOptions: Web3AuthOptions = {
  chainConfig,
  clientId,
  web3AuthNetwork: WEB3AUTH_NETWORK.SAPPHIRE_MAINNET,
  // add-next-line
  privateKeyProvider,
}

const web3auth = new Web3Auth(web3AuthOptions)
```

### Default EVM Adapter Enhancements

In v9, the functionality of `getDefaultExternalAdapters` has changed. Previously, it displayed injected wallets available in the browser. Starting from v9, it will now show a list of WalletConnect-compatible wallets, enabling users to connect via WalletConnect if a wallet is not already installed. Please look at the image below.

![getDefaultExternalAdapters image](/img/migration-guides/default-adapter.png)

Additionally, a new `getInjectedAdapters` function has been introduced, which detects injected wallets and, if none are available, prompts users with an option to install one. Refer to the image below for details: ![getInjectedAdapters image](/img/migration-guides/injected-adapter.png)

The key difference between `getInjectedAdapters` and `getDefaultExternalAdapters` lies in their handling of missing wallets. While `getInjectedAdapters` provides users with an installation option when no wallet is found, `getDefaultExternalAdapters` allows users to connect via WalletConnect in the absence of an installed wallet.

#### Show Injected Wallets

```ts
import { getInjectedAdapters } from '@web3auth/default-evm-adapter'
const adapters = await getInjectedAdapters({ options: web3AuthOptions })

adapters.forEach(adapter => {
  web3auth.configureAdapter(adapter)
})
```

#### Show WalletConnect-Compatible Wallets

```ts
import { getDefaultExternalAdapters } from '@web3auth/default-evm-adapter'

const adapters = await getDefaultExternalAdapters({ options: web3AuthOptions })

adapters.forEach(adapter => {
  web3auth.configureAdapter(adapter)
})
```

### Default Solana Adapter Enhancements

In v9, a new `getInjectedAdapters` function has been introduced, working similarly to `getDefaultExternalAdapters`. This function has been added to align with default EVM adapter. Unlike the default EVM adapter, there is no functionality change for `getDefaultExternalAdapters`.

### External Wallet Adapters Deprecation

Starting with v9, external wallet adapters for Metamask, Phantom, Solflare, and Slope are deprecated in favor of the Default EVM Adapter and Default Solana Adapter. These new adapters use MIPD to automatically detect injected wallets.

#### Metamask Adapter Migration

```ts
// remove-next-line
import { MetamaskAdapter } from '@web3auth/metamask-adapter'
// add-next-line
import { getInjectedAdapters } from '@web3auth/default-evm-adapter'

// remove-next-line
const metamaskAdapter = new MetamaskAdapter()
// add-start
const adapters = await getInjectedAdapters({ options: web3AuthOptions })
const metamaskAdapter = adapters.find(e => e.name == 'metamask')
// add-end

web3auth.configureAdapter(metamaskAdapter)
```

#### Phantom Adapter Migration

```ts
// remove-next-line
import { PhantomAdapter } from '@web3auth/phantom-adapter'
// add-next-line
import { getInjectedAdapters } from '@web3auth/default-solana-adapter'

// remove-next-line
const phantomAdapter = new PhantomAdapter()
// add-start
const adapters = await getInjectedAdapters({ options: web3AuthOptions })
const phantomAdapter = adapters.find(e => e.name == 'phantom')
// add-end

web3auth.configureAdapter(phantomAdapter)
```

#### Solflare Adapter Migration

```ts
// remove-next-line
import { SolflareAdapter } from '@web3auth/solflare-adapter'
// add-next-line
import { getInjectedAdapters } from '@web3auth/default-solana-adapter'

// remove-next-line
const solflareAdapter = new SolflareAdapter()
// add-start
const adapters = await getInjectedAdapters({ options: web3AuthOptions })
const solflareAdapter = adapters.find(e => e.name == 'solflare')
// add-end

web3auth.configureAdapter(solflareAdapter)
```

#### Slope Adapter Migration

```ts
// remove-next-line
import { SlopeAdapter } from '@web3auth/slope-adapter'
// add-next-line
import { getInjectedAdapters } from '@web3auth/default-solana-adapter'

// remove-next-line
const slopeAdapter = new SlopeAdapter()
// add-start
const adapters = await getInjectedAdapters({ options: web3AuthOptions })
const slopeAdapter = adapters.find(e => e.name == 'slope')
// add-end

web3auth.configureAdapter(slopeAdapter)
```

### Hooks Auto Init

Starting with v9, the `initModal` method for initializing the Modal SDK has been removed. Initialization is now handled internally by the hooks.

```ts title="App.tsx"
// remove-start
const { initModal } = useWeb3Auth();
await initModal(params: {
    modalConfig: {
        [WALLET_ADAPTERS.AUTH]: {
        label: "auth",
        loginMethods: {
            apple: {
                name: "apple",
                showOnModal: false,
            },
        },
    },
  },
});
// remove-end
```

The modal config instead of `initModal` now needs to be passed in `Web3AuthContextConfig`.

```ts title="web3AuthProviderProps.ts"
const web3AuthContextConfig: Web3AuthContextConfig = {
  web3AuthOptions,
  // add-start
  modalConfig: {
    [WALLET_ADAPTERS.AUTH]: {
      label: 'auth',
      loginMethods: {
        apple: {
          name: 'apple',
          showOnModal: false,
        },
      },
    },
  },
  // add-end
  adapters: [openloginAdapter],
  plugins: [walletServicesPlugin],
}
```

### Minor Changes

In v9, there are also minor changes that improves the developer experience, and overall performance.

#### JSON-RPC Method Deprecations

Starting v9, the `eth_signTypedData_v1` and `eth_signTypedData_v3` are now deprecated. These method can no longer be used. If you were using one of them, you should now use `eth_signTypedData_v4`.

#### Status and Events Improvement

After v9, all the status and events in Web3Auth are now typed. This addition significantly improves the developer experience, and reduces chances for runtime error.

## Additional Changes

Apart from breaking changes, there are lot of enhancements, and quality of life improvement.

### Wallet Services Enhancements

In v9, there has been significant enhancements to the Wallet Services plugin. Now, you can programmatically control the modals's visibility. Along with that the build size is reduced by 25%. Please checkout the parameters, and their usage wrt their functions.

#### TopUp Parameters

| Name | Description |
| --- | --- |
| `receiveWalletAddress?` | Specifies the recipient's address. By default, it is set to the currently connected address. |
| `tokenList?` | Specifies the tokens to display in the list. By default, all tokens are shown. Use the ticker name to specify which tokens to display, such as `[USDC, USDT, ETH]`. Please checkout the coverage details for [full list of supported networks and tokens](/docs/features/topup#network-coverage). |
| `fiatList?` | Specifies the available fiat currencies enabled for purchase. Use the currency acronym to define which fiat currencies to display, such as `[USD, SGD, INR, JPY]`. Please checkout the coverage details for [full list of supported currencies](/docs/features/topup#country-and-payment-method-coverage). |
| `show` | Determines whether the checkout UI is displayed. This can be used to programmatically control its visibility. |

#### WalletConnect Scanner Parameters

| Name | Description |
| --- | --- |
| `show` | Determines whether the Wallet Connect UI is displayed. This can be used to programmatically control its visibility. |

#### Wallet UI Parameters

| Name | Description |
| --- | --- |
| `show` | Determines whether the wallet UI is displayed. This can be used to programmatically control its visibility. |
| `path?` | Specifies the path for the wallet services. |

### Functionality To Enable Key Export

Starting v9, the private key export functionality for Web3Auth PnP Web SDK can be disabled from the dashboard. If the key export is disabled, the `eth_private_key` and `solanaPrivateKey` RPC methods would throw error. By default, the key export will be enabled.

<img
  style={{ display: 'block', maxHeight: '600px', margin: '20px auto' }}
  src={Dashboard}
  alt="Showing How Web3Auth Key Generation works"
/>
