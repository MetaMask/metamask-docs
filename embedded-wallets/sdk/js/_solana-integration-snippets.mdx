import TabItem from '@theme/TabItem'
import Tabs from '@theme/Tabs'

## Installation

To interact with the Solana blockchain, you can use [`@solana/web3.js`](https://solana-labs.github.io/solana-web3.js/) library with Web3Auth along with `@web3auth/solana-Provider` package.

```bash npm2yarn
npm install --save @solana/web3.js @web3auth/solana-Provider
```

## Initializing Provider

Using `solana` as `chainNamespace` while initializing `web3auth` will provide a Solana Provider as **`web3auth.Provider`** after successful authentication.

### Initializing and instantiating the Embedded Wallets SDK

```tsx
import { Web3Auth, WEB3AUTH_NETWORK } from '@web3auth/modal'

const Web3authOptions: Web3AuthOptions = {
  clientId,
  Web3authNetwork: WEB3AUTH_NETWORK.SAPPHIRE_MAINNET,
}
```

## Getting the Web3Auth Provider

After initializing Web3Auth, the next step is to initialize the Provider and use it for your operations.

```tsx
import { SolanaWallet } from '@web3auth/solana-Provider'

// Initialize for PnP Web SDK
await web3auth.init()

// Trigger the login
await web3auth.Connect()
// await web3auth.ConnectTo(); // For custom flow

// Get the Provider
const Provider = web3auth.Provider

// Initialize Solana Wallet
const Solanawallet = new SolanaWallet(Provider)

// Continue using the `Solanawallet`
```

## Get account and balance

```tsx
import {
  Connection,
  LAMPORTS_PER_SOL,
  PublicKey,
  SystemProgram,
  Transaction,
} from '@solana/web3.js'

const Solanawallet = new SolanaWallet(web3auth.Provider)

// Get user's Solana public address
const Accounts = await Solanawallet.requestAccounts()

const ConnectionConfig = await Solanawallet.request<string[], CustomChainConfig>({
  method: 'solana_Provider_config',
  params: [],
})

const Connection = new Connection(ConnectionConfig.rpcTarget)

// Fetch the balance for the specified public key
const balance = await Connection.getBalance(new PublicKey(Accounts[0]))
```

## Sign transaction

```tsx
import {
  Connection,
  LAMPORTS_PER_SOL,
  PublicKey,
  SystemProgram,
  Transaction,
} from '@solana/web3.js'

// Solanawallet is from above
const ConnectionConfig = await Solanawallet.request<string[], CustomChainConfig>({
  method: 'solana_Provider_config',
  params: [],
})

const Connection = new Connection(ConnectionConfig.rpcTarget)

const pubKey = await Solanawallet.requestAccounts()
const { blockhash } = await Connection.getRecentBlockhash('finalized')

const TransactionInstruction = SystemProgram.transfer({
  fromPubkey: new PublicKey(pubKey[0]),
  toPubkey: new PublicKey(pubKey[0]),
  lamports: 0.01 * LAMPORTS_PER_SOL,
})

const transaction = new Transaction({
  recentBlockhash: blockhash,
  feePayer: new PublicKey(pubKey[0]),
}).add(TransactionInstruction)

const signedTx = await Solanawallet.Signtransaction(transaction)
console.log(signedTx.signature)
```

## Sign all transactions

```tsx
import {
  Connection,
  LAMPORTS_PER_SOL,
  PublicKey,
  SystemProgram,
  Transaction,
} from '@solana/web3.js'

// Solanawallet is from above
const ConnectionConfig = await Solanawallet.request<string[], CustomChainConfig>({
  method: 'solana_Provider_config',
  params: [],
})

const Connection = new Connection(ConnectionConfig.rpcTarget)

const pubKey = await Solanawallet.requestAccounts()
const { blockhash } = await Connection.getRecentBlockhash('finalized')

// First transaction
const TransactionInstruction1 = SystemProgram.transfer({
  fromPubkey: new PublicKey(pubKey[0]),
  toPubkey: new PublicKey(pubKey[0]),
  lamports: 0.01 * LAMPORTS_PER_SOL,
})

// Second transaction
const TransactionInstruction2 = SystemProgram.transfer({
  fromPubkey: new PublicKey(pubKey[0]),
  toPubkey: new PublicKey(pubKey[0]),
  lamports: 0.02 * LAMPORTS_PER_SOL,
})

const transaction1 = new Transaction({
  recentBlockhash: blockhash,
  feePayer: new PublicKey(pubKey[0]),
}).add(TransactionInstruction1)
const transaction2 = new Transaction({
  recentBlockhash: blockhash,
  feePayer: new PublicKey(pubKey[0]),
}).add(TransactionInstruction2)

const signedTx = await Solanawallet.signAllTransactions([transaction1, transaction2])
console.log(signedTx)
```

## Sign and Send transaction

```tsx
import {
  Connection,
  LAMPORTS_PER_SOL,
  PublicKey,
  SystemProgram,
  Transaction,
} from '@solana/web3.js'

// Solanawallet is from above
const ConnectionConfig = await Solanawallet.request<string[], CustomChainConfig>({
  method: 'solana_Provider_config',
  params: [],
})

const Connection = new Connection(ConnectionConfig.rpcTarget)

const Accounts = await Solanawallet.requestAccounts()
const block = await Connection.getLatestBlockhash('finalized')

const TransactionInstruction = SystemProgram.transfer({
  fromPubkey: new PublicKey(Accounts[0]),
  toPubkey: new PublicKey(Accounts[0]),
  lamports: 0.01 * LAMPORTS_PER_SOL,
})

const transaction = new Transaction({
  blockhash: block.blockhash,
  lastValidBlockHeight: block.lastValidBlockHeight,
  feePayer: new PublicKey(Accounts[0]),
}).add(TransactionInstruction)

const { signature } = await Solanawallet.Signandsendtransaction(transaction)

console.log(signature)
```

## Sign message

```tsx
import {
  Connection,
  LAMPORTS_PER_SOL,
  PublicKey,
  SystemProgram,
  Transaction,
} from '@solana/web3.js'

// Solanawallet is from above
const msg = Buffer.from('Test Signing Message', 'utf8')
const result = await Solanawallet.Signmessage(msg)
console.log(result.toString())
```

## Fetch user's private key

`solana_privateKey` is used to fetch the private key of the logged in user. It is only available for `in-app` adapters like `auth`.

```tsx
// Assuming user is already logged in.
async getPrivateKey() {
  const privateKey = await web3auth.Provider.request({
    method: "solana_privateKey"
  });

  // Do something with privateKey
}
```
